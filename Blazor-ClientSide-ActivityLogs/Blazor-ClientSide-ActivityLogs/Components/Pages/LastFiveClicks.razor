@page "/"

@using Blazor_ClientSide_ActivityLogs.Components.ClickLogging

@inject ClickLoggerService ClickLogger

@rendermode InteractiveServer

<div id="clickPopupContainer" style="position: fixed; top: 1rem; right: 1rem; z-index: 9999;">
</div>

<h3>Latest 5 from Service</h3>

<button class="btn btn-primary" @onclick="GetClickData">Show clicks</button>

<div class="clicks-container">
    @if (lastFiveClicks is not null && lastFiveClicks.Any())
    {
        <ul>
            @foreach (var click in lastFiveClicks)
            {
                <li>
                    <strong>Time:</strong> @click.Time <br />
                    <strong>Time:</strong> @click.Target <br />
                    <strong>Route:</strong> @click.Route <br />
                    <strong>Class:</strong> @click.Class <br />
                    <strong>Position:</strong> (@click.X, @click.Y)
                </li>
            }
        </ul>
    }
</div>

@* Example elements to test logging activity *@
<div class="sandbox-container">
    <a href="/LastFiveFromService">Link</a>
    <button class="btn btn-primary">Button</button>
    <input type="text" class="form-control" />
    <div class="alert alert-primary">Div</div>
    <p>Paragraph</p>
    <span>Span</span>
    <table class="table">
        <tr>
            <td>Table</td>
        </tr>
    </table>
    <img src="favicon.png" alt="Image" />
    <svg width="100" height="100">
        <circle cx="50" cy="50" r="40" stroke="black" stroke-width="3" fill="red" />
    </svg>
    <canvas id="myCanvas" width="200" height="100" style="border:1px solid #000000;"></canvas>
    <audio controls>
        <source src="horse.ogg" type="audio/ogg">
        <source src="horse.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    <video width="320" height="240" controls>
        <source src="movie.mp4" type="video/mp4">
        <source src="movie.ogg" type="video/ogg">
        Your browser does not support the video tag.
    </video>
    <iframe src="https://www.w3schools.com" title="W3Schools.com"></iframe>
    <object data="horse.ogg" type="application/x-shockwave-flash" width="0" height="0">s
        <param name="movie" value="horse.swf">
    </object>
    <embed src="helloworld.swf" width="0" height="0">
    <applet code="HelloWorld.class" width="0" height="0">
        Your browser does not support the applet tag.
    </applet>
    <marquee>Marquee</marquee>
    <blink>Blink</blink>
    <center>Center</center>
    <font size="7">Font</font>
</div>

@code {
    private List<ClickEntry> lastFiveClicks = new();

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
        
        await GetClickData();
    }

    private async Task GetClickData()
    {
        lastFiveClicks = await ClickLogger.GetLastFiveClicksAsync();
    }
}